(function(r,c){typeof exports=="object"&&typeof module<"u"?c(exports):typeof define=="function"&&define.amd?define(["exports"],c):(r=typeof globalThis<"u"?globalThis:r||self,c(r.Pieces={}))})(this,function(r){"use strict";class c{constructor(){this.width=0}format(t,n,i){return""}fstep(t,n,i){return""}toString(){return"Empty"}}class k{constructor(t){this.text=t,this.width=t.length}format(t,n,i){return i.column+=this.width,this.text}fstep(t,n,i){return n.column+=this.width,this.text}toString(){return JSON.stringify(this.text)}}class A{constructor(t,n){this.doc1=t,this.doc2=n,this.width=t.width}format(t,n,i){return t?this.doc1.format(!0,n,i):this.doc2.format(!1,n,i)}fstep(t,n,i){return t.doc=t.flat?this.doc1:this.doc2,null}toString(){return`(IfFlat ${this.doc1} ${this.doc2})`}}class ${constructor(){this.width=1/0}format(t,n,i){return console.assert(!t),i.line=i.line+1,i.column=n,i.lastIndent=n,`
`+" ".repeat(n)}fstep(t,n,i){return n.line=n.line+1,n.column=t.indent,n.lastIndent=t.indent,`
`+" ".repeat(t.indent)}toString(){return"HardLine"}}class I{constructor(t){this.width=t}format(t,n,i){return i.column+=this.width," ".repeat(this.width)}fstep(t,n,i){return n.column+=this.width," ".repeat(this.width)}toString(){return`(Blank ${this.width})`}}class E{constructor(t,n){this.doc1=t,this.doc2=n,this.width=t.width+n.width}format(t,n,i){const s=this.doc1.format(t,n,i),h=this.doc2.format(t,n,i);return s+h}fstep(t,n,i){return t.doc=this.doc1,i.push({type:u.Append1,doc2:this.doc2,flat:t.flat,indent:t.indent}),null}toString(){return`(Append ${this.doc1} ${this.doc2})`}}class y{constructor(t){this.doc=t,this.width=t.width}format(t,n,i){return this.doc.format(t||i.canFlatten(i.column+this.doc.width),n,i)}fstep(t,n,i){return t.doc=this.doc,t.flat=t.flat||n.canFlatten(n.column+this.doc.width),null}toString(){return`(Group ${this.doc})`}}class F{constructor(t,n){this.indent=t,this.doc=n,this.width=n.width}format(t,n,i){return this.doc.format(t,Math.max(n+this.indent,0),i)}fstep(t,n,i){return t.doc=this.doc,t.indent=Math.max(t.indent+this.indent,0),null}toString(){return`(Nest ${this.indent} ${this.doc})`}}class T{constructor(t){this.doc=t,this.width=t.width}format(t,n,i){return this.doc.format(t,i.column,i)}fstep(t,n,i){return t.doc=this.doc,t.indent=n.column,null}toString(){return`(Align ${this.doc})`}}class g{constructor(t,n,i,s,h){this.lineWidth=t,this.ribbonWidth=n,this.lastIndent=i,this.line=s,this.column=h}canFlatten(t){return t<=this.lineWidth&&t<=this.ribbonWidth+this.lastIndent}}const W=(e,t,n)=>{let i=new g(e,t,0,0,0);const s=i.canFlatten(n.width);return n.format(s,0,i)},u={Append1:0,Append2:1};function M(e,t,n){const i=e.pop();if(i.type===u.Append1)return n.doc=i.doc2,n.flat=i.flat,n.indent=i.indent,e.push({type:u.Append2,s1:t}),null;if(i.type===u.Append2)return i.s1+t}const N=(e,t,n)=>{let i=new g(e,t,0,0,0),s={doc:n,indent:0,flat:i.canFlatten(n.width)};const h=[];let d=null;for(let b=0;b<5e5;b++)if(d===null)d=s.doc.fstep(s,i,h);else{if(h.length===0)return d;d=M(h,d,s)}throw new Error("Exceeded maximum number of steps. Do you really need to pretty print that?")},l=new c,o=e=>e instanceof c,a=(e,t)=>o(e)&&o(t)?l:new A(e,t),f=e=>e===0?l:new I(e),p=new $,O=e=>a(f(e),p),R=a(f(1),p),j=e=>{if(e.length===0)return l;if(e.includes(`
`))throw new Error("Text cannot contain newline characters. Use `hardline` instead.");return new k(e)},w=(e,t)=>o(e)?t:o(t)?e:new E(e,t),m=(...e)=>e.length===0?l:e.reduceRight((t,n)=>w(n,t)),_=e=>o(e)||e.width===1/0||e instanceof y?e:new y(e),S=(...e)=>e.length===1?_(e[0]):_(m(...e)),B=e=>(...t)=>{const n=m(...t);return e===0?n:new F(e,n)},G=e=>o(e)?l:new T(e),H=e=>(t,...n)=>n.reduce((i,s)=>w(i,S(w(e,s))),t);r.align=G,r.append=m,r.blank=f,r.empty=l,r.flow=H,r.group=S,r.hardline=p,r.ifflat=a,r.isEmpty=o,r.nest=B,r.pretty=N,r.prettyRec=W,r.space=R,r.t=j,r.tab=O,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});
